(function(){var a=jQuery.sheet.advancedfn={FACTORIAL:function(b){fact=1;for(i=b;i>0;i--){fact*=i}return fact},COMBINATION:function(c,b){return a.FACTORIAL(c)/a.FACTORIAL(b)/a.FACTORIAL(c-b)},PERMUTATION:function(c,b){return a.FACTORIAL(c)/a.FACTORIAL(c-b)},GAMMA:function(b){if(b>0){if(b!=Math.floor(b)){var d=1;while(b<8){d*=b;b++}var c=1/(b*b);return exp(((((((((-3617/122400)*c+7/1092)*c-691/360360)*c+5/5940)*c-1/1680)*c+1/1260)*c-1/360)*c+1/12)/b+0.5*Math.log(2*Math.PI)-Math.log(d)-b+(b-0.5)*Math.log(b))}else{return a.FACTORIAL(b-1)}}return false},PRECISION:function(b,c){var d=Math.pow(10,Math.floor(Math.log(1/c)*Math.LOG10E));return Math.round(d*b)/d},MINIMUM:function(){var b=a.external.sanitize(arguments);var c=b[0];for(i=0;i<b.length;i++){if(b[i]<c){c=b[i]}}return c},MODE:function(){var d=a.external.sanitize(arguments);var f=d.sort(function(l,j){return l-j});var g=1;var c=0;var h=[];var e=[];for(i=0;i<f.length;i++){if(f[i]==f[i+1]){g++}else{h[c]=g;e[c]=f[i];c++;g=1}}var b=h[0];c=0;for(i=0;i<h.length;i++){if(h[i]>b){b=h[i];c=i}}return e[c]},MEDIAN:function(){var b=a.external.sanitize(arguments);var c=b.sort(function(e,d){return e-d});return c[Math.round((b.length)/2)-1]},QUARTILES:function(){var b=a.external.sanitize(arguments);var c=b.sort(function d(f,e){return f-e});return[c[Math.round((c.length)/4)-1],c[Math.round((c.length)/2)-1],c[Math.round((c.length)*3/4)-1]]},VARIANCE:function(){var b=a.external.sanitize(arguments);var d=[];var c=a.external.mean(b);for(i=0;i<b.length;i++){d[i]=Math.pow(b[i]-c,2)}return a.external.sum(d)/b.length},MEANDEV:function(){var b=a.external.sanitize(arguments);var c=[];var d=a.external.sum(b);for(i=0;i<b.length;i++){c[i]=Math.abs(b[i]-d)}return a.external.sum(c)/b.length},STDEV:function(){var b=a.external.sanitize(arguments),c=a.external.sum(b)/b.length,d=[];for(key in b){d[key]=Math.pow(b[key]-c,2)}return Math.sqrt(a.external.sum(d)/(d.length-1))},COVARIANCE:function(e,c){var d=a.external.mean(e);var b=a.external.mean(c);var f=[];for(i=0;i<e.length;i++){f[i]=(e[i]-d)*(c[i]-b)}return a.external.sum(f)/e.length},CORR_COEFF:function(c,b){return a.COVARIANCE(c,b)/a.STDEV(c)/a.STDEV(b)},UNIFORMCDF:function(e,d,c){if(c<e){return 0}else{if(c<d){return(c-e)/(d-e)}}return 1},BINOMIAL:function(d,c,b){return a.COMBINATION(d,b)*Math.pow(c,b)*Math.pow(1-c,d-b)},BINOMIALCDF:function(f,e,b){if(b<0){return 0}var d=[];for(k=0;k<f;k++){d[k]=a.BINOMIAL(f,e,k)}if(b<f){var c=0;for(i=0;i<=b;i++){c+=d[i]}return c}return 1},NEGBIN:function(c,d,b){if(b!=Math.floor(b)){return false}if(b<0){return 0}else{return a.COMBINATION(b+c-1,c-1)*Math.pow(d,c)*Math.pow(1-d,b)}},NEGBINCDF:function(e,d,b){if(b<0){return 0}var c=0;for(k=0;k<=b;k++){c+=a.NEGBIN(e,d,k)}return c},HYPGEOM:function(d,c,e,b){if(b!=Math.floor(b)){return false}if(b<0){return 0}else{return a.COMBINATION(c,b)*a.COMBINATION((d-c),e-b)/a.COMBINATION(d,e)}},HYPGEOMCDF:function(e,c,f,b){if(b<0){return 0}var d=0;for(k=0;k<=b;k++){d+=a.HYPGEOM(e,c,f,k)}return d},EXPONENTIALCDF:function(c,b){return 1-Math.exp(-c*b)},POISSON:function(c,b){return Math.pow(c,b)*Math.exp(-c)/a.FACTORIAL(b)},POISSONCDF:function(c,b){if(b<0){return 0}var d=0;for(k=0;k<=b;k++){d+=a.POISSON(c,k)}return d},NORMCDF:function(b,d,c){return a.ASR(Function("x","return Math.exp(-Math.pow(x-"+b+",2)/Math.pow("+d+",2)/2)/"+d+"/Math.sqrt(2*Math.PI)"),0,c,1e-14)},LINEAR_REQ_EQ:function(g,j){var d=a.external.mean(g);var b=a.external.mean(j);var h=[];var f=[];for(i=0;i<g.length;i++){h[i]=(g[i]-d)*(j[i]-b);f[i]=Math.pow(j[i]-b,2)}var e=a.external.sum(h)/a.external.sum(f);var c=d-e*b;return Function("x","return "+e+"*x+"+c)},EXP_REG_EQ:function(f,j){for(i=0;i<f.length;i++){(f[i]=Math.log(f[i]))}var d=a.external.mean(f);var c=a.external.mean(j);var g=[];var e=[];for(i=0;i<f.length;i++){g[i]=(f[i]-d)*(j[i]-c);e[i]=Math.pow(j[i]-c,2)}var b=a.external.sum(g)/a.external.sum(e);var h=Math.exp(d-b*c);return Function("x","return Math.exp("+b+"*x)*"+h)},SECANTMETHOD:function(f,e,b,c,j){var h;for(n=1;n<=j;n++){var g=f(b);h=(b-e)/(g-f(e))*g;if(Math.abs(h)<c){return b}e=b;b=b-h}return b},FIVEPT:function(d,b,c){return(-d(b+c*2)+8*d(b+c)-8*d(b-c)+d(b-c*2))/c/12},FCRIT:function(e,d,c){return a.PRECISION(a.SECANTMETHOD(Function("t","return jQuery.sheet.advancedfn.FIVEPT("+e+",t,1e-3)"),d,c,1e-13,99999),1e-12)},ASR:function(m,q,p,r){var o=(q+p)/2;var l=(p-q)/6;var g=m(q);var e=m(p);var d=m(o);var j=function(y,E,C,B,H,z,w,v,t){var G=(E+B)/2;var A=(B+C)/2;var x=(B-E)/6;var D=y(A);var s=y(G);var u=(w+4*s+t)*x;var F=(t+4*D+v)*x;if(Math.abs(u+F-z)<=15*H){return u+F+(u+F-z)/15}return j(y,E,B,G,H/2,u,w,t,s)+j(y,B,C,A,H/2,F,t,v,D)};return a.PRECISION(j(m,q,p,o,r,l*(g+e+4*d),g,e,d),r)}};a.external=jQuery.sheet.advancedfn.external={sum:function(b){b=this.sanitize(b);var c=0;for(i=0;i<b.length;i++){c+=b[i]}return c},mean:function(b){b=this.sanitize(b);return a.external.sum(b)/b.length},sanitize:function(){return arrHelpers.toNumbers(arguments)}}})();