(function(a,b){a.sheet.dts={toTables:{json:function(x){var n=a([]),h,p,l,e,f,r,q,t,c,s;for(var w=0;w<x.length;w++){h=x[w];var y=a(b.createElement("table"));if(h.title){y.attr("title",h.title||"")}n=n.add(y);p=h.rows;for(var v=0;v<p.length;v++){l=p[v];if(s=(l.height+"").replace("px","")){var d=a(b.createElement("tr")).attr("height",s).css("height",s+"px").appendTo(y)}e=l.columns;for(var u=0;u<e.length;u++){f=e[u];var m=a(b.createElement("td")).appendTo(d);if(f["class"]){m.attr("class",f["class"]||"")}if(f.style){m.attr("style",f.style||"")}if(f.formula){m.attr("data-formula",(f.formula?"="+f.formula:""))}if(f.cellType){m.attr("data-celltype",f.cellType||"")}if(f.value){m.html(f.value||"")}if(f.rowspan){m.attr("rowspan",f.rowspan||"")}if(f.colspan){m.attr("colspan",f.colspan||"")}}}if(r=h.metadata){if(q=r.widths){var o=a(b.createElement("colgroup")).prependTo(y);for(var u=0;u<q.length;u++){t=(q[u]+"").replace("px","");var g=a(b.createElement("col")).attr("width",t).css("width",t+"px").appendTo(o)}}if(c=r.frozenAt){if(c.row){y.attr("data-frozenatrow",c.row)}if(c.col){y.attr("data-frozenatcol",c.col)}}}}return n},xml:function(k){k=a.parseXML(k);var q=a([]),h=k.getElementsByTagName("spreadsheets")[0].getElementsByTagName("spreadsheet"),n,u,o,f,j,C,x,I,w,t,v,z,y;for(var F=0;F<h.length;F++){n=h[F];var H=a(b.createElement("table")).attr("title",(n.attributes.title?n.attributes.title.nodeValue:"")),s=a(b.createElement("colgroup")).appendTo(H),d=a(b.createElement("tbody")).appendTo(H);q=q.add(H);u=n.getElementsByTagName("rows")[0].getElementsByTagName("row");x=n.getElementsByTagName("metadata")[0];for(var D=0;D<u.length;D++){o=u[D];var e=a(b.createElement("tr")).appendTo(d);if(y=o.attributes.height){y=(y.nodeValue||"").replace("px","");e.css("height",y).attr("height",y+"px")}f=o.getElementsByTagName("columns")[0].getElementsByTagName("column");for(var B=0;B<f.length;B++){j=f[B];var p=a(b.createElement("td")).appendTo(e),c=j.getElementsByTagName("formula")[0],E=j.getElementsByTagName("cellType")[0],A=j.getElementsByTagName("value")[0],G=j.getElementsByTagName("style")[0],r=j.getElementsByTagName("class")[0],J=j.getElementsByTagName("rowspan")[0],g=j.getElementsByTagName("colspan")[0];if(c){p.attr("data-formula","="+(c.textContent||c.text))}if(E){p.attr("data-celltype",E.textContent||E.text)}if(A){p.html(A.textContent||A.text)}if(G){p.attr("style",G.textContent||G.text)}if(r){p.attr("class",r.textContent||r.text)}if(J){p.attr("rowspan",J.textContent||J.text)}if(g){p.attr("colspan",g.textContent||g.text)}}}v=x.getElementsByTagName("width");for(var D=0;D<v.length;D++){z=(v[D].textContent||v[D].text).replace("px","");a(b.createElement("col")).attr("width",z).css("width",z+"px").appendTo(s)}I=x.getElementsByTagName("frozenAt")[0];if(I){t=I.getElementsByTagName("col")[0];w=I.getElementsByTagName("row")[0];if(t){H.attr("data-frozenatcol",(t.textContent||t.text)*1)}if(w){H.attr("data-frozenatrow",(w.textContent||w.text)*1)}}}return q}},fromTables:{json:function(m,g){g=(g==undefined?false:g);var p=[],u=1*m.i,h=m.spreadsheets.length-1,v,k,l,f,n,t,e,c,r,o,q,s,j,d;if(h<0){return p}do{s=false;m.i=h;m.evt.cellEditDone();v={title:(m.obj.table().attr("title")||""),rows:[],metadata:{widths:[],frozenAt:a.extend({},m.obj.pane().actionUI.frozenAt)}};p.unshift(v);k=m.spreadsheets[h];l=k.length-1;do{j=k[l][1].td[0].parentNode;d=j.style.height;t={columns:[],height:(d?d.replace("px",""):m.s.colMargin)};f=k[l].length-1;do{c=k[l][f];e={};r=c.td[0].attributes;if(g||s||r["class"]||c.formula||c.value||r.style){s=true;o=(r["class"]?a.trim((r["class"].value||"").replace(m.cl.uiCellActive,"").replace(m.cl.uiCellHighlighted,"")):"");q=c.td[0].parentNode;t.columns.unshift(e);if(!t.height){t.height=(q.style.height?q.style.height.replace("px",""):m.s.colMargin)}if(c.formula){e.formula=c.formula}if(c.cellType){e.cellType=c.cellType}if(c.value){e.value=c.value}if(r.style&&r.style.value){e.style=r.style.value}if(o.length){e["class"]=o}if(r.rowspan){e.rowspan=r.rowspan.value}if(r.colspan){e.colspan=r.colspan.value}}if(l*1==1){v.metadata.widths.unshift(a(m.col(null,f)).css("width").replace("px",""))}}while(f-->1);if(s){v.rows.unshift(t)}}while(l-->1)}while(h--);m.i=u;return p},xml:function(o,j){j=(j==undefined?false:j);var r="",y=1*o.i,k=o.spreadsheets.length-1,d,m,n,h,p,w,x,f,e,u,q,s,c,v,t,l,g;if(k<0){return r}do{v=false;o.i=k;o.evt.cellEditDone();c=a.extend({},o.obj.pane().actionUI.frozenAt);t=[];m=o.spreadsheets[k];n=m.length-1;w="";do{f="";h=m[n].length-1;do{x="";e=m[n][h];u=e.td[0].attributes;q=(u["class"]?a.trim((u["class"].value||"").replace(o.cl.uiCellActive,"").replace(o.cl.uiCellHighlighted,"")):"");if(j||v||q||e.formula||e.value||u.style){v=true;x+="<column>";if(e.formula){x+="<formula>"+e.formula+"</formula>"}if(e.cellType){x+="<cellType>"+e.cellType+"</cellType>"}if(e.value){x+="<value>"+e.value+"</value>"}if(u.style){x+="<style>"+u.style.value+"</style>"}if(q){x+="<class>"+q+"</class>"}if(u.rowspan){x+="<rowspan>"+u.rowspan.value+"</rowspan>"}if(u.colspan){x+="<colspan>"+u.colspan.value+"</colspan>"}x+="</column>";f=x+f}if(n*1==1){t[h]="<width>"+a(o.col(null,h)).css("width").replace("px","")+"</width>"}}while(h-->1);if(f){l=m[n][1].td[0].parentNode;g=l.style.height;w='<row height="'+(g?g.replace("px",""):o.s.colMargin)+'"><columns>'+f+"</columns></row>"+w}}while(n-->1);d='<spreadsheet title="'+(o.obj.table().attr("title")||"")+'"><rows>'+w+"</rows><metadata>"+(c.row||c.col?"<frozenAt>"+(c.row?"<row>"+c.row+"</row>":"")+(c.col?"<col>"+c.col+"</col>":"")+"</frozenAt>":"")+"<widths>"+t.join("")+"</widths></metadata></spreadsheet>";r=d+r}while(k--);o.i=y;return'<?xml version="1.0" encoding="UTF-8"?><spreadsheets xmlns="http://www.w3.org/1999/xhtml">'+r+"</spreadsheets>"}}}})(jQuery,document);