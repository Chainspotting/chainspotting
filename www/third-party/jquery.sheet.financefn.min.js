(function(a){var c=NaN;var b=jQuery.sheet.financefn={NPV:function(h){h=h*1;var f=1,g=0,d;for(var e=1;e<arguments.length;e++){var f=f*(1+h);g+=arguments[e]/f}d=new Number(g);d.html=Globalize.format(g,"c");return d},PV:function(h,e,g,j,f){j=j||0;f=f||0;var i,d;if(h!=0){i=(-g*(1+h*f)*((Math.pow(1+h,e)-1)/h)-j)/Math.pow(1+h,e)}else{i=-j-g*e}d=new Number(i);d.html=Globalize.format(i,"c");return d},RATE:function(l,h,t,g,o,p){g=g||0;o=o||0;p=p||0.1;var n=p,q=0,k=0,u=128,m=1e-8,v;if(Math.abs(n)<m){q=t*(1+l*n)+h*(1+n*o)*l+g}else{k=Math.exp(l*Math.log(1+n));q=t*k+h*(1/n+o)*(k-1)+g}var s=t+h*l+g,r=t*k+h*(1/n+o)*(k-1)+g;var j=0,e=0,d=n;while((Math.abs(s-r)>m)&&(j<u)){n=(r*e-s*d)/(r-s);e=d;d=n;if(Math.abs(n)<m){q=t*(1+l*n)+h*(1+n*o)*l+g}else{k=Math.exp(l*Math.log(1+n));q=t*k+h*(1/n+o)*(k-1)+g}s=r;r=q;++j}v=new Number(n);v.html=Globalize.format(n,"p");return v},IPMT:function(i,f,e,j,k,h){var g=a.PMT(i,e,j,k,h),k=a.FV(i,f-1,g,j,h),d=k*i;if(h){d/=(1+i)}d=new Number(d);d.html=Globalize.format(d,"c");return d},PMT:function(h,e,i,j,g){h=parseFloat(h||0);e=parseFloat(e||0);i=parseFloat(i||0);j=j||0;g=g||0;var f=(h/(Math.pow(1+h,e)-1)*-(i*Math.pow(1+h,e)+j)),d;if(g==1){f=f/(1+h)}d=new Number(f);d.html=Globalize.format(f,"c");return d},NPER:function(h,g,i,j,f){var e,d;h=parseFloat(h||0);g=parseFloat(g||0);i=parseFloat(i||0);j=(j||0);f=(f||0);e=function(k){if(isNaN(k)){return Math.log(0)}var l=Math.log(k);return l};if(h==0){d=(-(i+j)/g)}else{if(f>0){d=(e(-(h*j-g*(1+h))/(h*i+g*(1+h)))/(e(1+h)))}else{d=(e(-(h*j-g)/(h*i+g))/(e(1+h)))}}if(isNaN(d)){d=0}return d},FV:function(h,e,g,i,f){i=(i?i:0);f=(f?f:0);var j=-(i*Math.pow(1+h,e)+g*(1+h*f)*(Math.pow(1+h,e)-1)/h),d=new Number(j);d.html=Globalize.format(j,"c");return d}}})(jQuery.sheet.fn);